(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[907],{95934:function(e,a,t){Promise.resolve().then(t.bind(t,41598))},58075:function(e,a,t){"use strict";t.d(a,{R:function(){return l},s:function(){return s}});let l=async e=>{let{queryKey:a}=e;try{let e=await fetch("".concat("http://localhost:4060").concat(a[0]));if(!e.ok)throw Error("Something went wrong ".concat(a[0]));return await e.json()}catch(e){throw Error(e)}},s=(e,a)=>async t=>{try{let l=await fetch("".concat("http://localhost:4060").concat(e),{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok)throw Error("Something went wrong ".concat(a," ").concat(e));return await l.json()}catch(e){throw Error(e)}}},41598:function(e,a,t){"use strict";t.r(a);var l=t(33584),s=t(33192),r=t(58e3),n=t(4053),i=t(19816),o=t.n(i),c=t(67930),d=t(20581),u=t(93527),m=t(23186),f=t(27979),v=t(77722),x=t(28938),p=t(47991),h=t(13920),b=t(27272),j=t(65325),g=t(42008),y=t(58075);let{TextArea:k}=d.default;a.default=e=>{let{params:a}=e,{isLoading:t,data:i,isSuccess:w}=(0,b.a)({queryKey:["/templates/".concat(a.id)]}),Z=(0,j.D)({mutationFn:(0,y.s)("/templates/".concat(a.id),"put")}),[N,C]=x.ZP.useMessage(),[F]=c.Z.useForm(),[I,P]=(0,h.useState)(!1),[E,S]=(0,h.useState)(""),[T,V]=(0,h.useState)(""),[D,O]=(0,h.useState)(""),L=async e=>{if(e.url)S(e.url);else{let a=URL.createObjectURL(e.originFileObj);S(a)}P(!0),V(e.name||e.url.substring(e.url.lastIndexOf("/")+1))};(0,h.useEffect)(()=>{if(i){if(i.data.cover){O(i.data.cover);let e=i.data.cover.split("/");i.data.cover=[{uid:-1,name:e[e.length-1],status:"done",url:i.data.cover}]}F.setFieldsValue(i.data)}},[i]);let[z,A]=(0,h.useState)(!1),M=(0,p.useRouter)(),U=async()=>{var e,a,t,l;let s=await F.validateFields();s.cover=(null===(l=s.cover)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:null===(a=t.response)||void 0===a?void 0:null===(e=a.url)||void 0===e?void 0:e[0])||D||"",Z.mutate(s,{onSuccess:()=>{N.success({content:"更新成功",duration:1}).then(()=>{M.push("/templates/")})},onError(e){N.error(e.message,1)}})};return(0,l.jsxs)(l.Fragment,{children:[C,t&&(0,l.jsx)(g.Z,{className:"fixed top-0 left-0 right-0 bottom-0 m-auto",label:"加載中..."}),w&&(0,l.jsxs)("div",{className:"mx-auto mt-5 w-2/5",children:[(0,l.jsxs)(c.Z.Provider,{onFormFinish:(e,a)=>{let{values:t,forms:l}=a;if("fieldForm"===e){let{template:e,fieldForm:a}=l,s=e.getFieldValue("fields")||[];e.setFieldsValue({fields:[...s,t]}),a.resetFields(),A(!1)}},children:[(0,l.jsxs)(c.Z,{name:"template",labelCol:{span:4},wrapperCol:{span:20},form:F,children:[(0,l.jsx)(c.Z.Item,{name:"name",label:"模版名称",rules:[{required:!0}],children:(0,l.jsx)(d.default,{})}),(0,l.jsx)(c.Z.Item,{name:"description",label:"模版描述",rules:[{required:!0}],children:(0,l.jsx)(k,{rows:3})}),(0,l.jsx)(c.Z.Item,{label:"模版封面",name:"cover",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null==e?void 0:e.fileList,children:(0,l.jsx)(v.default,{action:"".concat("http://localhost:4060","/upload"),onPreview:L,accept:".png,.jpg,.jpeg,.webp",maxCount:1,listType:"picture-card",children:(0,l.jsxs)("div",{children:[(0,l.jsx)(r.Z,{}),(0,l.jsx)("div",{style:{marginTop:8},children:"Upload"})]})})}),(0,l.jsx)(c.Z.Item,{name:"fields",hidden:!0}),(0,l.jsx)(c.Z.Item,{label:"模版字段",shouldUpdate:(e,a)=>e.fields!==a.fields,children:e=>{let{getFieldValue:a,setFieldsValue:t}=e,s=a("fields")||[];return s.length>0?(0,l.jsx)("div",{className:"flex flex-col gap-3",children:s.map((e,a)=>(0,l.jsxs)("div",{className:"gap-3 flex flex-row",children:[(0,l.jsx)(m.Z,{color:"success",children:e.fieldName}),(0,l.jsx)(m.Z,{color:"cyan",children:e.fieldType}),e.defaultValue&&(0,l.jsx)(m.Z,{color:"orange",children:e.defaultValue}),(0,l.jsx)(o(),{size:"small",danger:!0,onClick:()=>{t({fields:s.filter((e,t)=>t!==a)})},color:"danger",children:"删除"})]},e.fieldName+a))}):(0,l.jsxs)(f.Z.Text,{type:"secondary",children:["( ",(0,l.jsx)(n.Z,{})," 暂时没有模版字段 )"]})}}),(0,l.jsx)("div",{className:"w-56 mx-auto",children:(0,l.jsx)(o(),{type:"dashed",onClick:()=>{A(!0)},block:!0,icon:(0,l.jsx)(r.Z,{}),children:"添加模版字段"})}),(0,l.jsxs)("div",{className:"mt-6 flex justify-around",children:[(0,l.jsx)(o(),{type:"primary",onClick:M.back,children:"取消"}),(0,l.jsx)(o(),{type:"primary",onClick:U,children:"更新模版"})]})]}),(0,l.jsx)(s.Z,{open:z,onChange:A})]}),(0,l.jsx)(u.Z,{open:I,title:T,footer:null,onCancel:()=>{S(""),P(!1),V("")},children:(0,l.jsx)("img",{alt:"example",style:{width:"100%"},src:E})})]})]})}},33192:function(e,a,t){"use strict";var l=t(33584),s=t(67930),r=t(20581),n=t(93527),i=t(87337),o=t(39085),c=t(13920);a.Z=e=>{let[a,t]=(0,o.u)({controlled:e.open}),[d]=s.Z.useForm(),[u,m]=(0,c.useState)("text");return(0,l.jsx)(n.Z,{open:a,title:"添加模版字段",okText:"添加",cancelText:"取消",onCancel:()=>{e.onChange(!1)},onOk:()=>{d.validateFields().then(()=>{d.submit()})},children:(0,l.jsxs)(s.Z,{form:d,layout:"vertical",name:"fieldForm",children:[(0,l.jsx)(s.Z.Item,{name:"fieldName",label:"字段名",rules:[{required:!0}],children:(0,l.jsx)(r.default,{})}),(0,l.jsx)(s.Z.Item,{name:"fieldType",label:"字段类型",rules:[{required:!0}],children:(0,l.jsx)(i.default,{onChange:e=>{m(e)},options:[{value:"text",label:"字符串"},{value:"number",label:"数字"}]})}),(0,l.jsx)(s.Z.Item,{name:"defaultValue",label:"默认值",children:(0,l.jsx)(r.default,{type:u})})]})})}},42008:function(e,a,t){"use strict";t.d(a,{Z:function(){return x}});var l=t(53800),s=(0,t(99437).tv)({slots:{base:"flex flex-col justify-center gap-1 max-w-fit items-center",label:"",svgWrapper:"relative block",svg:"z-0 relative overflow-hidden",track:"h-full stroke-default-300/50",indicator:"h-full stroke-current",value:"absolute font-normal inset-0 flex items-center justify-center"},variants:{color:{default:{svg:"text-default-400"},primary:{svg:"text-primary"},secondary:{svg:"text-secondary"},success:{svg:"text-success"},warning:{svg:"text-warning"},danger:{svg:"text-danger"}},size:{sm:{svg:"w-8 h-8",label:"text-small",value:"text-[0.5rem]"},md:{svg:"w-10 h-10",label:"text-small",value:"text-[0.55rem]"},lg:{svg:"w-12 h-12",label:"text-medium",value:"text-[0.6rem]"}},isIndeterminate:{true:{svg:"animate-spinner-ease-spin"}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-all !duration-500"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1,disableAnimation:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{svg:"!transition-none motion-reduce:transition-none"}}]}),r=t(71986),n=t(29179),i=t(40697),o=t(3037),c=t(13920),d=t(10516),u=t(34283),m=t(16275),f=t(33584),v=(0,l.Gp)((e,a)=>{let{Component:t,slots:v,classNames:x,label:p,showValueLabel:h,getProgressBarProps:b,getLabelProps:j,getSvgProps:g,getIndicatorProps:y,getTrackProps:k}=function(e){var a;let[t,f]=(0,l.oe)(e,s.variantKeys),{ref:v,as:x,id:p,className:h,classNames:b,label:j,valueLabel:g,value:y,minValue:k=0,maxValue:w=100,strokeWidth:Z,showValueLabel:N=!1,formatOptions:C={style:"percent"},...F}=t,I=(0,r.gy)(v),P=(0,n.W)(null==b?void 0:b.base,h),[,E]=function(e={}){let{rerender:a=!1,delay:t=0}=e,l=(0,c.useRef)(!1),[s,r]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{l.current=!0;let e=null;return a&&(t>0?e=setTimeout(()=>{r(!0)},t):r(!0)),()=>{l.current=!1,a&&r(!1),e&&clearTimeout(e)}},[a]),[(0,c.useCallback)(()=>l.current,[]),s]}({rerender:!0,delay:100}),S=(null==(a=e.isIndeterminate)||a)&&void 0===y,{progressBarProps:T,labelProps:V}=function(e){let{value:a=0,minValue:t=0,maxValue:l=100,valueLabel:s,isIndeterminate:r,formatOptions:n={style:"percent"}}=e,i=(0,o.zL)(e,{labelable:!0}),{labelProps:c,fieldProps:f}=(0,u.N)({...e,labelElementType:"span"}),v=((a=(0,d.uZ)(a,t,l))-t)/(l-t),x=(0,m.Ux)(n);if(!r&&!s){let e="percent"===n.style?v:a;s=x.format(e)}return{progressBarProps:(0,o.dG)(i,{...f,"aria-valuenow":r?void 0:a,"aria-valuemin":t,"aria-valuemax":l,"aria-valuetext":r?void 0:s,role:"progressbar"}),labelProps:c}}({id:p,label:j,value:y,minValue:k,maxValue:w,valueLabel:g,formatOptions:C,isIndeterminate:S,"aria-labelledby":e["aria-labelledby"],"aria-label":e["aria-label"]}),D=(0,c.useMemo)(()=>s({...f,isIndeterminate:S}),[S,...Object.values(f)]),O=!!e.disableAnimation||E,L=Z||"sm"===e.size?2:3,z=16-L,A=2*z*Math.PI,M=(0,c.useMemo)(()=>O?S?.25:y?function(e,a=100){return Math.min(Math.max(e,0),a)}((y-k)/(w-k),1):0:0,[O,y,k,w,S]),U=A-M*A,_=(0,c.useCallback)((a={})=>({ref:I,"data-indeterminate":(0,i.PB)(S),"data-disabled":(0,i.PB)(e.isDisabled),className:D.base({class:P}),...(0,o.dG)(T,F,a)}),[I,D,S,e.isDisabled,P,T,F]),q=(0,c.useCallback)((e={})=>({className:D.label({class:null==b?void 0:b.label}),...(0,o.dG)(V,e)}),[D,b,V]),R=(0,c.useCallback)((e={})=>({viewBox:"0 0 32 32",fill:"none",strokeWidth:L,className:D.svg({class:null==b?void 0:b.svg}),...e}),[L,D,b]),W=(0,c.useCallback)((e={})=>({cx:16,cy:16,r:z,role:"presentation",strokeDasharray:`${A} ${A}`,strokeDashoffset:U,transform:"rotate(-90 16 16)",strokeLinecap:"round",className:D.indicator({class:null==b?void 0:b.indicator}),...e}),[D,b,U,A,z]),B=(0,c.useCallback)((e={})=>({cx:16,cy:16,r:z,role:"presentation",strokeDasharray:`${A} ${A}`,strokeDashoffset:0,transform:"rotate(-90 16 16)",strokeLinecap:"round",className:D.track({class:null==b?void 0:b.track}),...e}),[D,b,A,z]);return{Component:x||"div",domRef:I,slots:D,classNames:b,label:j,showValueLabel:N,getProgressBarProps:_,getLabelProps:q,getSvgProps:R,getIndicatorProps:W,getTrackProps:B}}({ref:a,...e}),w=b();return(0,f.jsxs)(t,{...w,children:[(0,f.jsxs)("div",{className:v.svgWrapper({class:null==x?void 0:x.svgWrapper}),children:[(0,f.jsxs)("svg",{...g(),children:[(0,f.jsx)("circle",{...k()}),(0,f.jsx)("circle",{...y()})]}),h&&(0,f.jsx)("span",{className:v.value({class:null==x?void 0:x.value}),children:w["aria-valuetext"]})]}),p&&(0,f.jsx)("span",{...j(),children:p})]})});v.displayName="NextUI.CircularProgress";var x=v}},function(e){e.O(0,[135,326,377,170,171,11,551,869,945,722,337,940,638,577,56,744],function(){return e(e.s=95934)}),_N_E=e.O()}]);